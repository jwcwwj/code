# 1.网络总体学习内容

网络编程阶段：网络基础1、套接字编程、网络基础2、网络基础3、高级IO。

网络编程1：网络编程前情提要。

套接字编程：网络通信程序的编写。

网络基础2、网络基础3：网络通信原理流程、协议解析。

高级IO：高并发模型。



网络基础：

网络基础1：网络的发展史、ip、端口、网络协议、网络数据传输的流程。

套接字编程：网络通信编程。

网络基础2/3：深入了解数据在网络中的传输，深入了解网络协议。

高级IO：IO概念以及多路转接模型，应用于网络服务器的并发模型。（跟业务挂钩才能完善）



# 2.本节目标

网络基础1：发展背景、ip地址、端口、通信协议、网络字节序。



# 3.网络分类

局域网、城域网、广域网：根据网络覆盖范围进行的网络划分。

局域网：描述的是覆盖范围在1000米以内。

城域网（国内的说法，国外没有）：覆盖范围在10到20km以内。

广域网：覆盖范围更大的网络。（20km以上）

互联网、因特网：相同的东西，不同的叫法，国际性的更大的广域网（具有国际范围的广域网）。

以太网、令牌环网：比较典型的组网方式（组网技术）。



# 4.网络基本知识

IP地址：一台主机在网络中的标识。

uint32_t类型的整数，IP地址数据类型。

IP地址是不够用的，通过DHCP技术（动态地址分配，谁上网给谁分配IP地址）、NAT技术（网络地址转换，组建私网）。（这里说的是IPv4） 

上面两种措施是应急措施，根本问题是IP地址不够用。

IPv4是32位，IPv6是128位。

IPv6才是从根本上解决IP地址不够用的问题。

IPv6不向前兼容IPv4。（学习的时候以IPv4为主）

每一个网络中的数据都会带有两条信息：源端IP地址，对端IP地址。

端口：网络通信中一台主机上进程的标识符。（不用进程ID的原因是进程ID会变。）

uint16_t类型的数据范围：0到65535。

每一个网络中的数据不但带有源端IP和对端IP，还会带有两条信息：源端I端口和对端端口，描述了数据从哪个主机的哪个进程发出要到哪个主机的哪个进程。

协议：约定

网络通信协议：说白了就是网络通信中的数据格式约定。

因此要实现网络互联，就必须具有统一的网络通信协议标准。



ISO组织：

OSI七层网络互连模型：以提供的服务不同将网络通信环境划分为7层。

层次划分：应用层、表示层、会话层、传输层、网络层、链路层、物理层。

TCP/IP五层模型：

应用层：负责应用程序之间的数据沟通；FTP协议用于文件传输的协议，HTTP协议是超文本传输协议。

传输层：负责进程之间的数据传输；UD协议和TCP协议

网络层：负责地址管理与路由选择；IP协议和路由器设备，路由器根据IP协议中的IP位置确定如何走。

链路层：负责相邻设备之间的数据传输；以太网协议eth和交换机设备，MAC地址，如何传输

物理层（如果四层就是没有物理层）：负责物理光电信号的传输；以太网协议，规定介质的规模和设定，集线器设备



查看协议：

![image-20230914132856735](C:\Users\19827\AppData\Roaming\Typora\typora-user-images\image-20230914132856735.png)

操作系统管的是传输层、网络层和链路层，不管物理层和应用层。

```shell
#查看以太网
vim /usr/include/net/ethernet.h
/ether_header
```

![image-20230914215426726](C:\Users\19827\AppData\Roaming\Typora\typora-user-images\image-20230914215426726.png)



网络字节序：是大端字节序。

主机字节序：一台主机上cpu对内存中数据按照字节为单位进行存取的顺序。（主机字节序是以字节为单位的，主要强调的是大小大于1字节的）（short、int、long、float、double）

分类：大端：低地址存高位；		小端：低地址存高位。

一个变量/数组的起始地址就是低地址，随着下标变大而变大。

大小端是由CPU决定的，CPU决定主要取决于CPU架构，英特尔（X86架构、AMD架构）架构是小端的，MIPS是大端的。

主机字节序对网络通信的影响：两个不同主机字节序主机之间的数据通信。

主机字节序不同，则有可能在网络通信中会产生数据二义。

想要避免因为主机字节序不同而导致的数据二义，则需要在网络中统一字节序标准。

网络字节序是大端字节序，也就意味着如果你的主机是小端的，则在网络通信时需要将数据转换为网络字节序后进行发送。

```shell
man 3 htonl		#库函数
```

```c
#include <arpa/inet.h>
uint32_t htonl(uint32_t hostlong);		//主机到网络字节序的32位转换
uint16_t htons(uint16_t hostshort);		//主机到网络字节序的16位转换
uint32_t ntohl(uint32_t netlong);		//网络到主机字节序的32位转换
uint16_t ntohs(uint16_t netshort);		//网络到主机字节序的16位转换
//64位需要自己实现接口，自己判断大小端，小段交换数据，大端什么也不用做。
```



# 5.总结

网络基础1：

分类：局域网、城域网、广域网（因特网/互联网）、以太网、令牌环网



IP地址：网络中每一台主机的唯一标识（不能出现重复）

ipv4：uint32_t无符号四字节整数;		解决方法：DHCP/NAT

ipv6：uint8_t ip[16]

网络的每一条数据中都具有两个信息：源端IP和对端IP



端口port：在一台主机上标识一个网络通信的进程。

目的是为了让接收方主机收到数据后能够知道应该哪个进程处理数据。

uint16_t：无符号2字节整数。

网络中的每一条数据中都具有两个信息：源端端口和对端端口。



协议：约定。

网络通信协议实际上就是网络通信两端的数据格式约定。

协议分层：将复杂网络环境按照提供的服务以及使用的接口协议不同划分层次；将网络通信层次清晰划分出来，更加容易实现网络互联。

OSI七层模型：应用层、表示层、会话层、传输层、网络层、链路层、物理层。

TCP/IP五层模型：

应用层：负责应用程序（更应该叫做进程）之间的数据沟通；（网络通信也是进程间通信）			例如：HTTP/FTP协议	（操作系统处理传输层到链路层之间

的）

传输层：负责进程之间的数据传输；	TCP/UDP

网络层：负责地址管理与路由选择；	IP协议/路由器设备

链路层：负责相邻设备之间的数据传输；	ETH协议/交换机设备

物理层：负责物理光电信号的传输；	以太网协议（规定网络通信宽带、双绞线有多粗、传输距离有多远、信号靠干扰能力）/集线器设备



网络字节序：

字节序：cpu对内存中数据进行存取的顺序。

主机字节序分类：

大端字节序：低地址存高位。

小端字节序：低地址存低位。

主机字节序对于网络通信的影响：通信两端主机字节序不同有可能造成数据二义。

解决方案：定义网络通信字节序标准，网络中的数据必须都是网络字节序，大端字节序。

发送方将数据转换为网络字节序的数据进行发送，接收方接收到数据之后根据自己主机字节序决定如何转换。

字节序针对的数据类型：存储单元大于一个字节的数据类型。（short、int、long、float、double）

字符串是不需要转换的，字符串中的每一个字符都是单字节存储的。		char buf[1024];



ip	端口	协议	网络字节序

五元组：sip（源端IP地址） + sport（源端端口） + dip（对端IP地址） + dport（对端端口） + protocol（协议）

五元组标识一条通信。

网络中的每条数据中都会包含有完整的五元组信息。
